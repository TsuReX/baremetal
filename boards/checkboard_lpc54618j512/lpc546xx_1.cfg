source [find target/swj-dp.tcl]
source [find mem_helper.tcl]

adapter_khz 4000

set _CHIPNAME lpc546xx
set _WORKAREASIZE 0x2000

if {[using_swd]} {
	set _TAPID 0x2ba01477
	swd newdap $_CHIPNAME cpu -expected-id $_TAPID
}

if {[using_jtag]} {
	set _TAPID 0x10caa02b
	jtag newtap $_CHIPNAME cpu -irlen 5 -expected-id $_TAPID
}

target create $_CHIPNAME.cpu cortex_m -chain-position $_CHIPNAME.cpu

$_CHIPNAME.cpu configure -work-area-phys 0x20000000 \
							-work-area-size $_WORKAREASIZE -work-area-backup 0

$_CHIPNAME.cpu configure -event examine-end {

	echo !!!examine-end!!!
}

$_CHIPNAME.cpu configure -event trace-config {

	echo !!trace-config!!
}

$_CHIPNAME.cpu configure -event reset-init {

	echo !!!reset-init!!!
}

$_CHIPNAME.cpu configure -event reset-start {

	echo !!!reset-start!!!
}

#cortex_m reset_config vectreset

targets